let list = [{
    type: "script-src",
    name: "Leadfeeder",
    pattern: "https:\/\/sc\.lfeeder\.com"
}, {
    type: "script-content",
    name: "Segment",
    pattern: "https://cdn.segment.com/"
}, {
    type: "script-async",
    name: "Albacross",
    pattern: "https://serve.albacross.com/"
}, {
    type: "script-async",
    name: "Salespanel",
    pattern: "https://salespanel.io/"
}, {
    type: "script-async",
    name: "Intercom",
    pattern: "https://widget.intercom.io/"
}, {
    type: "script-src",
    name: "Pipedrive Webform",
    pattern: "https://webforms.pipedrive.com/"
},{
    type: "iframe",
    name: "Pipedrive Webform",
    pattern: "pipedrivewebforms\.com\/form"
},{
    type: "iframe",
    name: "Pipedrive Webform",
    pattern: "webforms.pipedrive.com"
},{
    type: "script-content",
    name: "HelpScout Chat",
    pattern: "https://beacon-v2.helpscout.net"
}, {
    type: "iframe",
    name: "Drift Chat",
    pattern: "https://js.driftt.com/"
}, {
    type: "script-content",
    name: "Gravity Form",
    pattern: "gravityforms"
},{
    type: "a",
    name: "Calendly",
    pattern: "https:\/\/calendly\.com"
},{
    type: "iframe",
    name: "Calendly",
    pattern: "calendly\.com"
},{
    type: "script",
    name: "Pipedrive Leadbooster Chat",
    pattern: "https://leadbooster-chat.pipedrive.com"
},{
    type: "div",
    name: "Pipedrive Chat",
    pattern: "pipedrive-chat"
},{
    type: "script-src",
    name: "Pipedrive Leadbooster Chat",
    pattern: "https://leadbooster-chat.pipedrive.com"
},{
    type: "script-async",
    name: "Pipedrive Leadbooster Chat",
    pattern: "leadbooster-chat.pipedrive.com"
},{
    type: "link-content",
    name: "Ninja Form",
    pattern: "ninja-form"
},{
    type: "a",
    name: "Hubspot Meet",
    pattern: "https:\/\/meetings\.hubspot\.com"
},{
    type: "a",
    name: "Pipedrive Scheduler",
    pattern: "pipedrive\.com\/scheduler"
},{
    type: "iframe",
    name: "Continually Chat",
    pattern: "https:\/\/app\.continual\.ly\/leads"
},{
    type: "script-src",
    name: "Clearbit",
    pattern: "clearbitjs\.com"
},{
    type: "script-src",
    name: "Marketo Form",
    pattern: "Marketo"
},{
    type: "iframe",
    name: "Hubspot Meet",
    pattern: "https:\/\/meetings\.hubspot\.com"
},{
    type: "a",
    name: "Google Form",
    pattern: "https:\/\/docs\.google\.com\/forms"
},{
    type: "iframe",
    name: "Hubspot Chat",
    pattern: "\.hubspot\.com\/conversations"
},{
    type: "iframe",
    name: "Monday Form",
    pattern: "https:\/\/forms\.monday\.com\/forms"
},{
    type: "form",
    name: "Infusionsoft Form",
    pattern: "infusionsoft\.com\/app\/form"
},{
    type: "form",
    name: "Formspree Form",
    pattern: "https:\/\/formspree\.io"
},{
    type: "style",
    name: "Fusion Form",
    pattern: "fusion-form"
},{
    type: "script-src",
    name: "Hubspot Meet",
    pattern: "hsappstatic\.net\/MeetingsPublic"
},{
    type: "form",
    name: "Jot Form",
    pattern: "jotform\.com"
},{
    type: "script-src",
    name: "Jot Form",
    pattern: "jotform\.co"
},{
    type: "div",
    name: "Pipedrive chat",
    pattern: "pipedrive-chat"
},{
    type: "script-src",
    name: "Contact Form 7",
    pattern: "contact-form-7"
},{
    type: "form",
    name: "Drip Form",
    pattern: "https:\/\/www\.getdrip\.com\/forms"
},{
    type: "script-async",
    name: "Klaviyo Form",
    pattern: "klaviyo\.com"
},{
    type: "div",
    name: "Mura Form",
    pattern: "mura\-form"
},{
    type: "script-src",
    name: "Mailmunch Form",
    pattern: "mailmunch\.co"
},{
    type: "script-src",
    name: "Formstack",
    pattern: "formstack\.com\/forms"
},{
    type: "form",
    name: "SquareSpace Form",
    pattern: "squarespace\.com"
},{
    type: "iframe",
    name: "Formvio",
    pattern: "app\.formvio\.com"
},{
    type: "script-src",
    name: "Fresh Chat",
    pattern: "freshchat\.com"
},{
    type: "script-src",
    name: "WP Amelia Booking",
    pattern: "ameliabooking"
},{
    type: "script-src",
    name: "Hubspot Form",
    pattern: "hscollectedforms\.net"
},{
    type: "script-src",
    name: "Hubspot Meeting",
    pattern: "hsappstatic\.net\/MeetingsEmbed"
},{
    type: "iframe",
    name: "Livechat",
    pattern: "livechatinc\.com"
},{
    type: "form",
    name: "Demio Form",
    pattern: "demio\.com"
},{
    type: "iframe",
    name: "Wix Forms",
    pattern: "forms\.wix\.com"
},{
    type: "iframe",
    name: "Ascend Chat (WiX)",
    pattern: "engage\.wixapps\.net\/chat\-widget"
},{
    type: "form",
    name: "Freshworks Form",
    pattern: "myfreshworks\.com\/crm\/sales\/smart_form"
},{
    type: "form",
    name: "Hubspot Form",
    pattern: "forms.hsforms.com"
},{
    type: "script-src",
    name: "Crisp Chat",
    pattern: "client\.crisp\.chat"
},{
    type: "script-async",
    name: "Olark ",
    pattern: "static.olark.com"
},{
    type: "script-async",
    name: "Tidio Chat",
    pattern: "tidio.co"
},{
    type: "script-async",
    name: "Hotjar",
    pattern: "static.hotjar.com"
},{
    type: "iframe",
    name: "Typeform",
    pattern: "form\.typeform\.com"
},{
    type: "div-class",
    name: "Typeform",
    pattern: "typeform"
},{
    type: "link-content",
    name: "Calendly",
    pattern: "calendly\.com"
},{
    type: "form-content",
    name: "Contact Form",
    pattern: "contactForm"
},{
    type: "form-content",
    name: "Contact Form",
    pattern: "contact-form"
},{
    type: "script-src",
    name: "Tawkto Chat",
    pattern: "embed\.tawk\.to"
},{
    type: "script-src",
    name: "Smart Form",
    pattern: "smart-forms"
},{
    type: "button",
    name: "Mailchimp",
    pattern: "mc-embedded"
},{
    type: "link-content",
    name: "Mailchimp Signup form",
    pattern: "mailchimp.com/embedcode"
},{
    type: "script-async",
    name: "Mailchimp Static",
    pattern: "chimpstatic\.com\/mcjs"
},{
    type: "div-class",
    name: "Wordpress Form",
    pattern: "wpforms"
},{
    type: "script-src",
    name: "GoSquared LiveChat",
    pattern: "gs-chat.com/chat"
}





]


chrome.runtime.onMessage.addListener(
    function(request, sender, sendResponse) {
      if( request.message === "start" ) {
       start();
           }
    }
  );

  function start(){
      
  


        let result = [];
       

        for (var i = 0; i < list.length; i++) {

            if (list[i].type == "script-src") {

              

                let scriptelements = document.getElementsByTagName('script');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].src;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                }



            }
            else if (list[i].type == "script") {

              

                let scriptelements = document.getElementsByTagName('script');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].src;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                }



            }
            
            else if(list[i].type == "script-content") {
                
               

                let scriptelements = document.getElementsByTagName('script');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].innerHTML;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                     
                }
            }
            else if(list[i].type == "button") {
                
               

                let scriptelements = document.getElementsByTagName('button');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].id;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                     
                }
            }

            else if(list[i].type == "iframe") {

                let scriptelements = document.getElementsByTagName('iframe');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].src;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                }



            }
            
            else if(list[i].type == "a") {

      
                let scriptelements = document.getElementsByTagName('a');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].href;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                            result.push(list[i]);

                        }    

                       
                    }
                }
               
            
            
            else if (list[i].type == "script-async") {

         
                let scriptelements = document.getElementsByTagName('script');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].src;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                    }
            }

            else if (list[i].type == "link-content") {

               
                let scriptelements = document.getElementsByTagName('link');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].href;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                    }
            }
            else if (list[i].type == "form") {

               

                let scriptelements = document.getElementsByTagName('form');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].action;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                    }
            }
            else if (list[i].type == "form-content") {

            

                let scriptelements = document.getElementsByTagName('form');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].id;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                    }
            }
           
            
            else if (list[i].type == "style") {

               
                let scriptelements = document.getElementsByTagName('style');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].textContent;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                    }
            }
            
            else if (list[i].type == "div-id") {

                

                let scriptelements = document.getElementsByTagName('div');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].id;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                    }
            }
            
            
            else if (list[i].type == "div") {


                let scriptelements = document.getElementsByTagName('div');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].id;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                    }
            }
            
            
            else if (list[i].type == "div") {

                
                let scriptelements = document.getElementsByTagName('div');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].url;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }    
                    }
            }
            
            else if (list[i].type == "div-class") {

                

                let scriptelements = document.getElementsByTagName('div');


                for (var j = 0; j < scriptelements.length; j++) {
                    let value = scriptelements[j].className;
                    const re = new RegExp(list[i].pattern);
                    if (re.test(value) == true) {
                        result.push(list[i]);

                    }   
                    }
            }
                    
        }

        

       
        

        //filtering duplicates from array
        console.log(result);
        var sampleResult = [];
        for (var k =0; k<result.length;k++){
            sampleResult.push(result[k].name);
        }
        
    
        var distinctResult= Array.from(new Set(sampleResult));

        
       

            

            //console.log(distinctResult);
            chrome.runtime.sendMessage({
                data: distinctResult
            }, function (response) {
               // console.dir(response);
            });
       
    

    }

